source("https://bioconductor.org/biocLite.R")
biocLite("Biobase")
biocLite("Biobase")
library(Biobase)
load("/Users/federicocozza/Desktop/Federico Cozza/Tagliaferri/Dati Luca/all_exprs_data.RData")
lc4 <- exprs(expr.lc4)
View(lc4[1:9446,])
View(lc4[9446:nrow(lc4),])
labelsLC4 <- pData(expr.lc4)
labelsLC4
labelsLC4 <- labelsLC4[c(-1,-2,-3,-4,-5,-7)]
labelsLC4
rownames(lc4)
rownames(lc4)[9446]
lc4 <- exprs(expr.lc4)
lc4 <- lc4[1:9446,]
genes <- rownames(lc4)
for(i in 1:length(genes)){
genes[i] = strsplit(genes[i],split="_")[[1]][1]
}
rownames(lc4) <- genes
labelsLC4 <- pData(expr.lc4)
labelsLC4 <- labelsLC4[c(-1,-2,-3,-4,-5,-7)]
source("enrichmentReactomeAndKegg.R")
source("https://bioconductor.org/biocLite.R")
biocLite("ReactomePA")
source("enrichmentReactomeAndKegg.R")
biocLite("clusterProfiler")
source("enrichmentReactomeAndKegg.R")
biocLite("org.Hs.eg.db")
source("enrichmentReactomeAndKegg.R")
biocLite("SummarizedExperiment")
source("enrichmentReactomeAndKegg.R")
enrichRes <- enrichmentReactomeAndKeggByList(rownames(lc4))
enrichRes
enrichRes <- enrichmentReactomeAndKeggByList(rownames(lc4))
enrichRes[1]
enrichRes[[1]]
namePathway <- c(enrichRes$KEGGPathway@result$Description,enrichRes$ReactomePathway@result$Description)
mapping <- data.frame(ID =  c(paste("KEGG_",enrichRes$KEGGPathway@result$ID,sep=""),paste("REACTOME_",enrichRes$ReactomePathway@result$ID,sep="")),namePathway= c(enrichRes$KEGGPathway@result$Description,enrichRes$ReactomePathway@result$Description))
rownames(mapping) <- mapping$ID
View(mapping)
View(mapping)
source("R/getPathway.R")
minimumSizeOfPathway = 15
allPathways <- getPathways(enrichRes,RNA = lc4,minimumSizeOfPathway)
source("getPathway.R")
minimumSizeOfPathway = 15
allPathways <- getPathways(enrichRes,RNA = lc4,minimumSizeOfPathway)
allPathways[[1]]
names(allPathways)
dim(lc4)
table(labelsLC4$class)
mapping
allPathways[[1]]
names(allPathways)
length(allPathways)
str(allPathways[[1]])
length(labelsLC4)
dim(labelsLC4)
length(labelsLC4)[1]
length(labelsLC4)[2]
length(labelsLC4)[0]
dim(labelsLC4)[1]
pathwaysNumber <- length(allPathways)
subjectsNumber <- dim(labelsLC4)[1]
A <- matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12), nrow = 4, ncol = 3)
A
A <- matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12), nrow = 4, ncol = 3, byrow = TRUE)
A
colMedians(A)
median(c(1, 2, 3))
median(c(1, 4, 7, 10))
rm(A)
pathway = allPathways[[1]]
rm(pathway)
featurePathways[1]
featurePathways <- matrix(, nrow = pathwaysNumber, ncol = subjectsNumber)
featurePathways[1]
featurePathways[1,]
pathway = allPathways[[1]]
mediansPathway <- colMedians(pathway)
featurePathways[1, ] <- mediansPathway
length(featurePathways[1,])
featurePathways[1,]
featurePathways[,1]
rm(pathway)
rm(mediansPathway)
rm(featurePathways)
featurePathways <- matrix(0, nrow = pathwaysNumber, ncol = subjectsNumber)
for (i in 1:pathwaysNumber) {
pathway = allPathways[[i]]
mediansPathway <- colMedians(pathway)
featurePathways[i, ] <- mediansPathway
}
A <- matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9), nrow=3, ncol=3, byrow = TRUE)
A
t(A)
rm(A)
featurePathways <- t(featurePathways)
install.packages("RcppCNPy")
library(RcppCNPy)
npySave("dataset.npy", featurePathways)
View(featurePathways)
source('~/Desktop/Federico Cozza/Tagliaferri/Dati Luca/Progetto_R/Pathway/lungCancer.R', echo=TRUE)
labelsLC4$class
labelsLC4[which(labelsLC4 == "SCC1"),"class"] = 1
labelsLC4[which(labelsLC4 == "SCC2"),"class"] = 2
labelsLC4[which(labelsLC4 == "AC1"),"class"] = 3
labelsLC4[which(labelsLC4 == "AC2"),"class"] = 4
labelsLC4$class
as.numeric(labelsLC4$class)
labelsLC4 <- as.numeric(labelsLC4$class)
npySave("labels.npy", labelsLC4)
source('~/Desktop/Federico Cozza/Tagliaferri/Dati Luca/Progetto_R/Pathway/lungCancer.R', echo=TRUE)
length(labelsLC4)
source('~/Desktop/Federico Cozza/Tagliaferri/Dati Luca/Progetto_R/Pathway/lungCancer.R', echo=TRUE)
